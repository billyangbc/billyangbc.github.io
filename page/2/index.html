<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free@6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://unpkg.com/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"billyangbc.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.21.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Practical Tech">
<meta property="og:url" content="http://billyangbc.github.io/page/2/index.html">
<meta property="og:site_name" content="Practical Tech">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Pratical Tech Blogger">
<meta property="article:tag" content="cloud native, kubernetes, docker, web application, AI">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://billyangbc.github.io/page/2/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Practical Tech</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Practical Tech</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Pratical Tech Blogger</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://billyangbc.github.io/2024/11/02/tech/tips-k8s/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Pratical Tech Blogger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Practical Tech">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Practical Tech">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/02/tech/tips-k8s/" class="post-title-link" itemprop="url">Kubernets Tips</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-11-02 00:00:00" itemprop="dateCreated datePublished" datetime="2024-11-02T00:00:00-07:00">2024-11-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-11-21 09:34:42" itemprop="dateModified" datetime="2024-11-21T09:34:42-08:00">2024-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="1-Install-helm"><a href="#1-Install-helm" class="headerlink" title="1. Install helm"></a>1. Install helm</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl https://baltocdn.com/helm/signing.asc | gpg --dearmor | <span class="built_in">sudo</span> <span class="built_in">tee</span> /usr/share/keyrings/helm.gpg &gt; /dev/null</span><br><span class="line"><span class="built_in">sudo</span> apt-get install apt-transport-https --<span class="built_in">yes</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;deb [arch=<span class="subst">$(dpkg --print-architecture)</span> signed-by=/usr/share/keyrings/helm.gpg] https://baltocdn.com/helm/stable/debian/ all main&quot;</span> | <span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/apt/sources.list.d/helm-stable-debian.list</span><br><span class="line"><span class="built_in">sudo</span> apt-get update</span><br><span class="line"><span class="built_in">sudo</span> apt-get install helm</span><br><span class="line">helm version</span><br></pre></td></tr></table></figure>

<h2 id="2-Install-kubernetes-dashboard-kuebets-dashboard"><a href="#2-Install-kubernetes-dashboard-kuebets-dashboard" class="headerlink" title="2. Install kubernetes dashboard kuebets-dashboard"></a>2. Install kubernetes dashboard <a target="_blank" rel="noopener" href="https://artifacthub.io/packages/helm/k8s-dashboard/kubernetes-dashboard">kuebets-dashboard</a></h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">helm repo add kubernetes-dashboard https://kubernetes.github.io/dashboard/</span><br><span class="line">helm upgrade --install kubernetes-dashboard kubernetes-dashboard/kubernetes-dashboard --create-namespace --namespace kubernetes-dashboard</span><br></pre></td></tr></table></figure>

<h2 id="3-Start-kubernetes-dashboard"><a href="#3-Start-kubernetes-dashboard" class="headerlink" title="3. Start kubernetes dashboard"></a>3. Start kubernetes dashboard</h2><p>To access dashboard, run:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kubernetes-dashboard port-forward svc/kubernetes-dashboard-kong-proxy 8443:443</span><br></pre></td></tr></table></figure>

<p>NOTE: In case port-forward command does not work, make sure that kong service name is correct. Check the services in Kubernetes Dashboard namespace using:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kubernetes-dashboard get svc</span><br></pre></td></tr></table></figure>

<p>Dashboard will be available at <code>https://localhost:8443</code></p>
<h2 id="4-Get-login-token-for-dashboard"><a href="#4-Get-login-token-for-dashboard" class="headerlink" title="4. Get login token for dashboard"></a>4. Get login token for dashboard</h2><p>To get login token for dashboard, run:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kubernetes-dashboard get sa</span><br><span class="line"><span class="comment"># get service account name e.g. kubernetes-dashboard-web</span></span><br><span class="line">kubectl -n kubernetes-dashboard create token kubernetes-dashboard-web</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://billyangbc.github.io/2024/10/04/tech/ssh-to-remote-server-with-no-pass/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Pratical Tech Blogger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Practical Tech">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Practical Tech">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/04/tech/ssh-to-remote-server-with-no-pass/" class="post-title-link" itemprop="url">SSH to remote server with passwordless authentication</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-04 00:00:00" itemprop="dateCreated datePublished" datetime="2024-10-04T00:00:00-07:00">2024-10-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-11-21 09:34:42" itemprop="dateModified" datetime="2024-11-21T09:34:42-08:00">2024-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>If you don’t want to use password to access remote server, you can setup with following steps:</p>
<h2 id="step-1-Generating-SSH-keys"><a href="#step-1-Generating-SSH-keys" class="headerlink" title="step 1: Generating SSH keys"></a>step 1: Generating SSH keys</h2><p>On the local host, create SSH keys by using the command</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure>

<p>The command generates three files:</p>
<ul>
<li>authorized_keys: A file storing the public keys form other hosts (manually create it if not existing) </li>
<li>id_ed25519.pub: public key</li>
<li>id_ed25519: private key</li>
</ul>
<h2 id="step-2-Copy-public-key-to-remote-host"><a href="#step-2-Copy-public-key-to-remote-host" class="headerlink" title="step 2: Copy public key to remote host"></a>step 2: Copy public key to remote host</h2><p>We will copy the public key <code>id_ed25519.pub</code> to the remote host’s <code>authorized_keys</code> file using the <code>ssh-copy-id</code> command.</p>
<p>On local host:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id -i id_ed25519.pub user@hostname.example.com</span><br><span class="line"></span><br><span class="line"><span class="comment">#cd ~/.ssh</span></span><br><span class="line"><span class="comment">#cat id_ed25519.pub</span></span><br><span class="line"><span class="comment">#cat id_ed25519.pub | pbcopy</span></span><br></pre></td></tr></table></figure>

<p>On the remote host:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.ssh/authorized_keys</span><br><span class="line"><span class="comment"># paste copied content</span></span><br></pre></td></tr></table></figure>

<h2 id="step-3-test-with-ssh"><a href="#step-3-test-with-ssh" class="headerlink" title="step 3: test with ssh"></a>step 3: test with ssh</h2><p>For testing:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh user@hostname.example.com</span><br><span class="line"><span class="comment"># note: no password is needed</span></span><br></pre></td></tr></table></figure>

<h2 id="Optional-remove-public-key-from-remote-host"><a href="#Optional-remove-public-key-from-remote-host" class="headerlink" title="(Optional): remove public key from remote host"></a>(Optional): remove public key from remote host</h2><p>To remove the public key from remote server, use:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">idssh=$(awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> ~/.ssh/id_ed25519.pub)</span><br><span class="line">ssh user@hostname.example.com <span class="string">&quot;sed -i &#x27;\#<span class="variable">$idssh</span>#d&#x27; .ssh/authorized_keys&quot;</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://billyangbc.github.io/2024/10/03/tech/prevent-ubuntu-sleep-when-lid-closed/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Pratical Tech Blogger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Practical Tech">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Practical Tech">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/03/tech/prevent-ubuntu-sleep-when-lid-closed/" class="post-title-link" itemprop="url">Make Ubuntu Not Sleep When laptop lid is closed</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-03 00:00:00" itemprop="dateCreated datePublished" datetime="2024-10-03T00:00:00-07:00">2024-10-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-11-21 09:34:42" itemprop="dateModified" datetime="2024-11-21T09:34:42-08:00">2024-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>In a multi-monitor setup, you probably want the laptop lid closed but it<br> should not suspend the system. Here’s how to ensure that with Ubuntu.</p>
<p>If you use Ubuntu on a laptop, you might have noticed that the system is suspended when you close the lid.</p>
<p>That’s<br> the expected behavior. It saves the battery as well as your work. You<br>lift the lid, the system wakes up, and you can log in and continue your<br>work.</p>
<p>That all sounds good except when you work with a<br>multi-monitor setup. A few people, like me, prefer to have the laptop<br>closed and only use the external monitor(s).</p>
<p>But if closing the laptop lid suspends the system, it creates a problem.</p>
<p>Let me show you how you can change this behavior.</p>
<h2 id="Don’t-sleep-when-laptop-lid-is-closed"><a href="#Don’t-sleep-when-laptop-lid-is-closed" class="headerlink" title="Don’t sleep when laptop lid is closed"></a>Don’t sleep when laptop lid is closed</h2><p>Actually, I have noticed that the recent versions of Ubuntu are<br>smarter in this sense. When the laptop is connected to a docking station<br> and you close the lid, it doesn’t go in suspend mode.</p>
<p>That’s the normal expected behavior but it may not work all the time for reasons known to Ubuntu gods.</p>
<p>The good thing is that you can force change this behavior using both GUI and command line.</p>
<p>Let me share both methods.</p>
<h3 id="Method-1-Using-GNOME-Teaks"><a href="#Method-1-Using-GNOME-Teaks" class="headerlink" title="Method 1: Using GNOME Teaks"></a>Method 1: Using GNOME Teaks</h3><p>If you are using the default GNOME desktop, you are in luck. <a target="_blank" rel="noopener" href="https://itsfoss.com/gnome-tweak-tool/">Install GNOME Tweaks tool in Ubuntu</a> from the software center or use this command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install gnome-tweaks</span><br></pre></td></tr></table></figure>

<p>Once installed, start the Tweaks application. In the <strong>General tab</strong> from the sidebar, <strong>toggle off the ‘Suspend when laptop lid is closed’ button</strong>.</p>
<h3 id="Method-2-Change-login-configuration-for-advanced-users"><a href="#Method-2-Change-login-configuration-for-advanced-users" class="headerlink" title="Method 2: Change login configuration (for advanced users)"></a>Method 2: Change login configuration (for advanced users)</h3><p>If you look into the content of the file &#x2F;etc&#x2F;systemd&#x2F;logind.conf,<br>you’ll see three different types of default settings for the laptop lid<br>closing.</p>
<ul>
<li>HandleLidSwitch: When the laptop is on battery power</li>
<li>HandleLidSwitchExternalPower: When the laptop is plugged into a power outlet</li>
<li>HandleLidSwitchDocked: When the laptop is connected to a docking station</li>
</ul>
<p>As you can see, the laptop will suspend if the lid is closed<br>irrespective of whether it is connected to power or not. Lid closing is<br>ignored for docking station connections.</p>
<p>If you want, you can change the value of those parameters to one of these as per your preference:</p>
<ul>
<li>lock: lock when lid is closed</li>
<li>ignore: do nothing</li>
<li>poweroff: shutdown</li>
<li>hibernate: hibernate when lid is closed</li>
</ul>
<p>I would suggest going with <code>ignore</code> if you don’t want your system do anything special when the laptop lid is closed.</p>
<ol>
<li>Open the <code>/etc/systemd/logind.conf</code> file in a text editor as root, for example,</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudoedit /etc/systemd/logind.conf</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>If <code>HandleLidSwitch</code> is not set to <code>ignore</code> then change it:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HandleLidSwitch=ignore</span><br></pre></td></tr></table></figure>

<p>You can either edit the <code>/etc/systemd/logind.conf</code> file and uncomment the said settings and change their value, or you create a new file in <code>/etc/systemd/logind.conf.d</code> directory. Create this directory if it doesn’t exist.</p>
<p>I am not going to give you the exact commands. If you are familiar with<br>the command line, you should be able to do it. If you are uncomfortable<br>with the command line, please stick with the earlier GUI method.</p>
<h3 id="Additional-issue"><a href="#Additional-issue" class="headerlink" title="Additional issue:"></a>Additional issue:</h3><p>If above doesn’t work, another trying is setting <code>IgnoreLid=true</code> in <code>/etc/UPower/UPower.conf</code></p>
<h2 id="Resolve-issue-that-wifi-turns-off"><a href="#Resolve-issue-that-wifi-turns-off" class="headerlink" title="Resolve issue that wifi turns off"></a>Resolve issue that wifi turns off</h2><p>issue: When my laptop screen turns off, my Wi-Fi turns off.</p>
<p>check: make sure the laptop is not suspending.</p>
<p>resolve: </p>
<ol>
<li><p>Settings -&gt; Power -&gt; Power Saving Options -&gt; Automatic Suspend<br>will allow you to change suspend behaviour (default to 20 mins).</p>
</li>
<li><p>Settings -&gt; Privacy -&gt; Screen -&gt; Screen Lock allows changing<br>screen lock behaviour is that’s linked to the issue.</p>
</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://billyangbc.github.io/2024/09/15/tech/stop-remove-all-docker-containers/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Pratical Tech Blogger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Practical Tech">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Practical Tech">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/15/tech/stop-remove-all-docker-containers/" class="post-title-link" itemprop="url">Stopping and Removing all Docker Containers</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-09-15 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-15T00:00:00-07:00">2024-09-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-11-21 09:34:42" itemprop="dateModified" datetime="2024-11-21T09:34:42-08:00">2024-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="For-the-impatient"><a href="#For-the-impatient" class="headerlink" title="For the impatient"></a>For the impatient</h2><p>Here is the command that will stop and remove all of the docker containers on your system, assuming the user running is a memember of the <code>docker</code> group.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -aq | xargs docker stop | xargs docker <span class="built_in">rm</span></span><br></pre></td></tr></table></figure>

<h2 id="Let’s-explain-how-it-work"><a href="#Let’s-explain-how-it-work" class="headerlink" title="Let’s explain how it work?"></a>Let’s explain how it work?</h2><p><a target="_blank" rel="noopener" href="https://www.cloudbees.com/blog/docker-how-to-stop-and-remove-all-containers-at-once#whats-xargs">https://www.cloudbees.com/blog/docker-how-to-stop-and-remove-all-containers-at-once#whats-xargs</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/45357771/stop-and-remove-all-docker-containers">https://stackoverflow.com/questions/45357771/stop-and-remove-all-docker-containers</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://billyangbc.github.io/2024/09/12/tech/ansible-inventory-with-yaml/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Pratical Tech Blogger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Practical Tech">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Practical Tech">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/12/tech/ansible-inventory-with-yaml/" class="post-title-link" itemprop="url">Writing Ansible Inventory Files in YAML Format</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-09-12 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-12T00:00:00-07:00">2024-09-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-11-21 09:34:42" itemprop="dateModified" datetime="2024-11-21T09:34:42-08:00">2024-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Main-Objectives"><a href="#Main-Objectives" class="headerlink" title="Main Objectives:"></a>Main Objectives:</h2><ol>
<li>Familiarize with the features of Ansible inventory files and understand the basic configuration of Ansible host lists.</li>
<li>Understand the format of Ansible inventory YAML files.</li>
</ol>
<h2 id="YAML-Static-Inventory-Files"><a href="#YAML-Static-Inventory-Files" class="headerlink" title="YAML Static Inventory Files"></a>YAML Static Inventory Files</h2><p>Ansible host lists are essential for using Ansible. Generally, the host list is written in a file named <code>inventory</code>, which by default uses the INI format. We usually create a new <code>inventory</code> file without a file extension and configure the host list location in <code>ansible.cfg</code>.</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[default]</span></span><br><span class="line">servera.example.com <span class="attr">ansible_user</span>=debian</span><br><span class="line"><span class="section">[web_servers]</span></span><br><span class="line">serverb.example.com</span><br><span class="line">serverc.example.com</span><br><span class="line"><span class="section">[db_servers]</span></span><br><span class="line">server<span class="section">[d:f]</span>.example.com</span><br></pre></td></tr></table></figure>

<p>The inventory file can also be in YAML format, which is easier to understand and write, and also easier for software to parse. For the above file, you can use the following YAML format file.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">default:</span></span><br><span class="line">  <span class="attr">hosts:</span></span><br><span class="line">    <span class="attr">servera.example.com:</span></span><br><span class="line">    <span class="attr">vars:</span></span><br><span class="line">      <span class="attr">ansible_user:</span> <span class="string">debian</span></span><br><span class="line"><span class="attr">web_servers:</span></span><br><span class="line">  <span class="attr">hosts:</span></span><br><span class="line">    <span class="attr">serverb.example.com:</span></span><br><span class="line">    <span class="attr">serverc.example.com:</span></span><br><span class="line"><span class="attr">db_servers:</span></span><br><span class="line">  <span class="attr">hosts:</span></span><br><span class="line">    <span class="string">server[d:f].example.com:</span></span><br></pre></td></tr></table></figure>

<p>You can use the following command to check the inventory file:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-inventory -i inventory.yaml --graph</span><br></pre></td></tr></table></figure>

<p>YAML inventory uses blocks to organize related configuration items. Each block starts with the name of the inventory group followed by a colon (:). Everything indented under the group name belongs to that group. If indented under the group name, the hostname block starts with the keyword <code>hosts</code>. All server names indented under <code>hosts</code> hosts belong to this group. These servers themselves form their own group, so they must end with a colon (:). You can also use the keyword <code>children</code> in the group block. The list of groups that belong to this group starts with this keyword. These member groups can have their own <code>hosts</code> and <code>children</code> blocks. YAML syntax has an advantage over INI syntax in that it organizes the server list and nested group list in the same place in the static inventory file.</p>
<p>The <code>all</code> group is implicitly all group implicitly exists at the top level and contains the rest of the inventory as its subset. It can also be explicitly listed in the YAML inventory but is not required:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">all:</span></span><br><span class="line">  <span class="attr">children:</span></span><br><span class="line">    <span class="attr">front_servers:</span> </span><br><span class="line">      <span class="attr">hosts:</span> </span><br><span class="line">        <span class="attr">servera.example.com:</span> </span><br><span class="line">    <span class="attr">web_servers:</span> </span><br><span class="line">      <span class="attr">hosts:</span> </span><br><span class="line">        <span class="attr">serverb.example.com:</span></span><br></pre></td></tr></table></figure>
<p>Equivalent to:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lb_servers:</span> </span><br><span class="line">  <span class="attr">hosts:</span> </span><br><span class="line">    <span class="attr">servera.1ab.example.com:</span> </span><br><span class="line"><span class="attr">web_servers:</span> </span><br><span class="line">  <span class="attr">hosts:</span> </span><br><span class="line">    <span class="attr">serverb.1ab.example.com:</span></span><br></pre></td></tr></table></figure>

<p>Some INI-based inventories contain hosts that are not members of any group. In a YAML-based static inventory, you can explicitly assign hosts to the <code>ungrouped</code> group:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">notinagroup.example.com</span><br><span class="line"><span class="section">[mailserver]</span></span><br><span class="line">mai1.example.com</span><br></pre></td></tr></table></figure>

<p>in yaml：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ungrouped:</span> </span><br><span class="line">  <span class="attr">hosts:</span> </span><br><span class="line">    <span class="attr">notinagroup.example.com:</span> </span><br><span class="line"><span class="attr">mailserver:</span> </span><br><span class="line">  <span class="attr">hosts:</span> </span><br><span class="line">    <span class="attr">mai1.example.com:</span></span><br></pre></td></tr></table></figure>

<p>Test the servers in the inventory file:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible -i inventory.yaml all -m ping</span><br></pre></td></tr></table></figure>

<h2 id="Setting-Vars-in-Ansible-Inventory-Files"><a href="#Setting-Vars-in-Ansible-Inventory-Files" class="headerlink" title="Setting Vars in Ansible Inventory Files"></a>Setting Vars in Ansible Inventory Files</h2><p>n the INI format, we can set inventory variables. In the YAML-based inventory file, we can also set inventory variables. In many cases, it is best practice to avoid storing variables in static inventory files. Many experienced Ansible developers prefer to use static inventory files to simply store information about the identity of managed hosts and which groups they belong to. Variables and their values are stored in the <code>host_vars</code> or <code>group_vars</code> files of the inventory. In some cases, you may want to keep variables such as <code>ansible_port</code> or <code>ansible_user</code> in the ansible_connection in the same file as the inventory itself, keeping this information in one place. If variables are set in too many different places, it becomes harder to remember where to set specific variables. In the YAML block of the group, you can use the vars keyword to set group variables directly in the YAML inventory file. Let’s look at the variable definitions in INI and YAML inventory files:</p>
<p>Group variables in INI format:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[monitoring]</span></span><br><span class="line">watcher.example.com</span><br><span class="line"></span><br><span class="line"><span class="section">[monitoring:vars]</span></span><br><span class="line"><span class="attr">smtp_relay</span>=smtp.example.com</span><br></pre></td></tr></table></figure>

<p>Group variables in YAML format:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">monitoring:</span></span><br><span class="line">  <span class="attr">hosts:</span></span><br><span class="line">    <span class="attr">watcher.example.com:</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">    <span class="attr">smtp_relay:</span> <span class="string">smtp.example.com</span></span><br></pre></td></tr></table></figure>

<p>Host variables in INI format:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[servers]</span></span><br><span class="line">servera.example.com</span><br><span class="line">localhost <span class="attr">ansible_connection</span>=local</span><br><span class="line">serverb.example.com</span><br></pre></td></tr></table></figure>

<p>Host variables in YAML format:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">servers:</span></span><br><span class="line">  <span class="attr">hosts:</span></span><br><span class="line">    <span class="attr">servera.example.com:</span></span><br><span class="line">    <span class="attr">localhost:</span></span><br><span class="line">      <span class="attr">ansible_connection:</span> <span class="string">local</span></span><br><span class="line">    <span class="attr">serverb.example.com:</span></span><br></pre></td></tr></table></figure>

<h2 id="Converting-from-INI-Format-to-YAML-Format"><a href="#Converting-from-INI-Format-to-YAML-Format" class="headerlink" title="Converting from INI Format to YAML Format"></a>Converting from INI Format to YAML Format</h2><p>You can use the <code>ansible-inventory</code> command to convert an INI-based inventory to YAML format. This tool is designed to display the entire configured inventory as seen by Ansible, and the result may differ from the original inventory file. The <code>ansible-inventory</code> command parses and tests the format of the inventory file but does not attempt to verify whether the hostnames in the inventory actually exist. Suppose there is an INI format inventory:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[lb_servers]</span></span><br><span class="line">servera.example.com</span><br><span class="line"></span><br><span class="line"><span class="section">[web_servers]</span></span><br><span class="line">serverb.example.com</span><br><span class="line">serverc.example.com</span><br><span class="line"></span><br><span class="line"><span class="section">[web_servers:vars]</span></span><br><span class="line"><span class="attr">alternate_server</span>=serverd.example.com</span><br><span class="line"></span><br><span class="line"><span class="section">[backend_server_pool]</span></span><br><span class="line">server<span class="section">[b:f]</span>.example.com</span><br></pre></td></tr></table></figure>

<p>Running the <code>ansible-inventory</code> command will output a YAML format inventory file:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-inventory  --yaml -i inventory --list --output dest_inventory.yaml</span><br></pre></td></tr></table></figure>

<p>If the conversion result is not satisfactory, you can manually modify the content.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://billyangbc.github.io/2024/09/03/tech/linux-envsubst-command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Pratical Tech Blogger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Practical Tech">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Practical Tech">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/03/tech/linux-envsubst-command/" class="post-title-link" itemprop="url">Linux envsubst Command with Examples</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-09-03 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-03T00:00:00-07:00">2024-09-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-11-21 09:34:42" itemprop="dateModified" datetime="2024-11-21T09:34:42-08:00">2024-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h2><p>In many cases, template, configuration, or initialization files  <strong>keep the names of bash variables as placeholders</strong> .<br>Thus, <strong>we need to fill in the variables’ values before actual use.</strong><br>We’re going to learn how to do just that with the <a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/envsubst.1.html"><em>envsubst</em></a> command.</p>
<h2 id="2-Basic-Features-of-envsubst"><a href="#2-Basic-Features-of-envsubst" class="headerlink" title="2. Basic Features of envsubst"></a>2. Basic Features of <em>envsubst</em></h2><p>The <em>envsubst</em> command searches the input for pattern *$VARIABLE *or  <em>${VARIABLE}</em> . <strong>Then, it replaces the pattern with the value of the corresponding bash variable.</strong><br>In contrast, a pattern that does not refer to any variable is replaced by an empty string.<br>Moreover,  <strong><em>envsubst</em> recognizes only <a target="_blank" rel="noopener" href="https://www.baeldung.com/linux/bash-variables-export">exported variables</a></strong> <em>.</em><br>The command is a part of the GNU ‘gettext’ package. Its basic syntax is:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">envsubst [OPTION] [SHELL-FORMAT]</span><br></pre></td></tr></table></figure>

<h2 id="3-Examples-of-Use"><a href="#3-Examples-of-Use" class="headerlink" title="3. Examples of Use"></a>3. Examples of Use</h2><p>Let’s prepare a simple greetings template in the file <em>welcome.txt</em>. We’re going to address the user with the name, add the desktop session’s name, and end up with a specific greeting:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello user <span class="variable">$USER</span> <span class="keyword">in</span> <span class="variable">$DESKTOP_SESSION</span>. It<span class="string">&#x27;s time to say $HELLO!</span></span><br></pre></td></tr></table></figure>

<p>Let’s export the HELLO variable:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> HELLO=<span class="string">&quot;good morning&quot;</span></span><br><span class="line">$ envsubst &lt; welcome.txt</span><br><span class="line">Hello user joe <span class="keyword">in</span> Lubuntu. It<span class="string">&#x27;s time to say good morning!</span></span><br></pre></td></tr></table></figure>

<p>And now, let’s unset this variable:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">unset</span> HELLO</span><br><span class="line">$ envsubst &lt; welcome.txt</span><br><span class="line">Hello user joe <span class="keyword">in</span> Lubuntu. It<span class="string">&#x27;s time to say !</span></span><br></pre></td></tr></table></figure>

<h2 id="4-Specify-Variables-with-SHELL-FORMAT"><a href="#4-Specify-Variables-with-SHELL-FORMAT" class="headerlink" title="4. Specify Variables with SHELL-FORMAT"></a>4. Specify Variables with SHELL-FORMAT</h2><p><strong>The <em>SHELL-FORMAT</em> argument selects variables for substitution.</strong><br>That is, only variables mentioned in this argument will be replaced. <strong>All other variables and all other words containing the dollar sign remain untouched.</strong><br>The variable pattern is the same as with the command input – *$VARIABLE *or  <em>${VARIABLE}</em> .<br>Let’s give it a check on the <em>shell_format_test.txt</em> input file:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This is <span class="variable">$FOO</span> and this <span class="variable">$BAR</span></span><br></pre></td></tr></table></figure>

<p>Also, let’s set and export two variables, <em>FOO</em> and  <em>BAR</em> :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> FOO=foo <span class="built_in">export</span> BAR=bar</span><br></pre></td></tr></table></figure>

<p>Now, we’re going to replace only  <em>FOO</em> :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ envsubst <span class="string">&#x27;$FOO&#x27;</span> &lt; shell_format_test.txt</span><br><span class="line">This is foo and this <span class="variable">$BAR</span></span><br></pre></td></tr></table></figure>
<p>We should use apostrophes around the content of <em>SHELL-FORMAT</em>  <strong>to prevent variable substitution before the call to <em>envsubst</em></strong> .</p>
<h2 id="5-The-Format-of-SHELL-FORMAT"><a href="#5-The-Format-of-SHELL-FORMAT" class="headerlink" title="5. The Format of SHELL-FORMAT"></a>5. The Format of <em>SHELL-FORMAT</em></h2><p>Let’s note that the structure of <em>SHELL-FORMAT</em> is very flexible. For example, variables may form a delimited list:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ envsubst <span class="string">&#x27;$FOO,$BAR&#x27;</span> &lt; shell_format_test.txt</span><br><span class="line">This is foo and this bar</span><br></pre></td></tr></table></figure>
<p>Or, they can be a part of any text:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ envsubst <span class="string">&#x27;Please deal with $FOO and $BAR&#x27;</span>&lt; shell_format_test.txt</span><br><span class="line">This is foo and this bar</span><br></pre></td></tr></table></figure>
<p>The variable pattern must contain only alphanumeric ASCII characters and underscores and may not start with a digit.</p>
<h2 id="6-Substituting-All-Environment-Variables"><a href="#6-Substituting-All-Environment-Variables" class="headerlink" title="6. Substituting All Environment Variables"></a>6. Substituting All Environment Variables</h2><p>As an example,  <strong>let’s replace all environment variables found in our <em>welcome.txt</em> template file</strong> :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ envsubst <span class="string">&quot;<span class="subst">$(printf &#x27;$&#123;%s&#125; &#x27; $(env | cut -d&#x27;=&#x27; -f1)</span>)&quot;</span> &lt; welcome.txt</span><br><span class="line">Hello user joe <span class="keyword">in</span> Lubuntu. It<span class="string">&#x27;s time to say $HELLO!</span></span><br></pre></td></tr></table></figure>

<p>Now, let’s analyze the <em>SHELL-FORMAT</em> argument.<br>First, the <a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/env.1p.html"><em>env</em></a> command provides a list of variables and their values in pairs. Then, we <a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/cut.1.html"><em>cut</em></a> each pair and extract the variable’s name.<br>Finally, <a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/printf.1.html"><em>printf</em></a> puts this name into curly braces and adds a leading dollar sign.</p>
<h2 id="7-Listing-the-Content-of-SHELL-FORMAT"><a href="#7-Listing-the-Content-of-SHELL-FORMAT" class="headerlink" title="7. Listing the Content of SHELL-FORMAT"></a>7. Listing the Content of <em>SHELL-FORMAT</em></h2><p>Let’s use a <em>-v</em> or <em>–variables</em> switch to print all variables present in the <em>SHELL-FORMAT</em> argument. <strong>With this option, no actual substitution takes place.</strong><br>So, let’s print names of all environment variables in a rather fancy way (with the help of <em><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/xargs.1.html">xargs</a></em> and <a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/column.1.html"><em>column</em></a>):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ envsubst <span class="string">&quot;<span class="subst">$(printf &#x27;$&#123;%s&#125; &#x27; $(env | cut -d&#x27;=&#x27; -f1)</span>)&quot;</span> --variables | xargs -L4 | column -t</span><br><span class="line">XDG_VTNR               LC_PAPER                  LC_ADDRESS           XDG_SESSION_ID</span><br><span class="line">XDG_GREETER_DATA_DIR   SELINUX_INIT              LC_MONETARY          SAL_USE_VCLPLUGIN</span><br><span class="line">CLUTTER_IM_MODULE      SESSION                   GPG_AGENT_INFO       TERM</span><br></pre></td></tr></table></figure>

<h2 id="8-Conclusion"><a href="#8-Conclusion" class="headerlink" title="8. Conclusion"></a>8. Conclusion</h2><p>In this article, we looked through some of the details of the <em>envsubst</em> command. Furthermore, we studied examples of its use.<br>Finally, we showed how to use <em>envsubst</em> to replace all referenced environment variables in a text file with their corresponding values from the shell environment.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://billyangbc.github.io/2024/08/23/tech/nfs/docker-nfs-server-v4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Pratical Tech Blogger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Practical Tech">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Practical Tech">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/08/23/tech/nfs/docker-nfs-server-v4/" class="post-title-link" itemprop="url">Using Docker to build nfs server</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-08-23 00:00:00" itemprop="dateCreated datePublished" datetime="2024-08-23T00:00:00-07:00">2024-08-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-11-21 09:34:42" itemprop="dateModified" datetime="2024-11-21T09:34:42-08:00">2024-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="nfs-server-V4"><a href="#nfs-server-V4" class="headerlink" title="nfs server (V4)"></a>nfs server (V4)</h2><ul>
<li><p>docker image:</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://hub.docker.com/r/gists/nfs-server">gists&#x2F;nfs-server</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/sjiveson/nfs-server-alpine">itsthenetwork&#x2F;nfs-server-alpine</a></li>
</ol>
</li>
<li><p>docker run:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /opt/nfs-server/share</span><br><span class="line">docker <span class="built_in">rm</span> -f nfs-server</span><br><span class="line"></span><br><span class="line">docker run \</span><br><span class="line">    -d \</span><br><span class="line">    --name nfs-server \</span><br><span class="line">    --restart=always   \</span><br><span class="line">    --privileged \</span><br><span class="line">      -p 32049:2049    \</span><br><span class="line">    -v /opt/nfs-server/share:/nfs-share \</span><br><span class="line">     -e NFS_DIR=/nfs-share   \</span><br><span class="line">     -e NFS_DOMAIN=*   \</span><br><span class="line">     -e NFS_OPTION=<span class="string">&quot;fsid=0,rw,sync,no_root_squash,all_squash,anonuid=0,anongid=0,no_subtree_check&quot;</span>   \</span><br><span class="line">    gists/nfs-server</span><br><span class="line">    </span><br><span class="line">docker logs -f  nfs-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker run \</span></span><br><span class="line"><span class="comment">#    -d \</span></span><br><span class="line"><span class="comment">#    --name nfs-server \</span></span><br><span class="line"><span class="comment">#    --restart=always   \</span></span><br><span class="line"><span class="comment">#    --privileged \</span></span><br><span class="line"><span class="comment">#      -p 32049:2049    \</span></span><br><span class="line"><span class="comment">#    -v /opt/nfs-server/share:/nfs-share \</span></span><br><span class="line"><span class="comment">#     -e SHARED_DIRECTORY=/nfsshare   \</span></span><br><span class="line"><span class="comment">#     -e SYNC=true   \</span></span><br><span class="line"><span class="comment">#    itsthenetwork/nfs-server-alpine</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>client:<br>Note: use ‘&#x2F;‘ instead of ‘&#x2F;nfs-share’</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /data/nfs-share</span><br><span class="line"><span class="comment"># mount</span></span><br><span class="line">mount -v -t nfs -o port=32049 host:/ /data/nfs-share</span><br><span class="line"><span class="comment"># umount</span></span><br><span class="line">umount /data/nfs-share</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://unpkg.com/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/@next-theme/pjax@0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  






  





</body>
</html>
